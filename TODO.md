# Linux-LX-DOS 開発計画

## 1. プロジェクト概要

本プロジェクトは、QEMU/KVMを利用してLinux上でWindowsアプリケーションをシームレスに実行するためのQtベースのランチャーアプリケーションです。ユーザーは本アプリケーションを通じて、Windows仮想マシンを管理し、その中で動作するWindowsアプリケーションをLinuxデスクトップ上で直接利用できるようになることを目指します。

## 2. 現在の開発状況

### 2.1. Qtアプリケーション (C++)
-   **基本UI:** VMの起動・停止ボタン、ログ出力エリアを持つメインウィンドウが実装済み。
-   **初回起動設定:** アプリケーション初回起動時に、Windows QEMUディスクイメージのパスを設定するウェルカムダイアログが実装済み。設定は`QSettings`により永続化される。
-   **QEMU連携:** QEMUプロセスの起動・停止をRustバックエンド経由で行うようにC++側が実装済み。QEMUからの標準出力/標準エラー出力はQtのログエリアに表示される。

### 2.2. Rustバックエンド
-   **QEMUプロセス管理:** QEMUプロセスの起動、停止、および標準出力/標準エラー出力の非同期監視を行うRustライブラリ (`rust_backend`) が実装済み。
-   **FFI (Foreign Function Interface):** C++からRustの関数 (`start_vm`, `stop_vm`) を呼び出すためのC言語互換インターフェースが定義済み。
-   **ログコールバック:** Rust側でQEMUからのログを受信するたびに、C++側のコールバック関数を呼び出し、QtのUIにメッセージを送信する仕組みが実装済み。

### 2.3. ビルドシステム
-   CMake (`CMakeLists.txt`) を使用して、C++アプリケーションとRustバックエンドの両方をビルドする設定が完了。
-   `ExternalProject`モジュールにより、RustライブラリのビルドがC++アプリケーションのビルドに統合されている。
-   `Cargo.toml`の`[lib]`セクションで`name = "rust_backend"`と`crate-type = ["staticlib"]`が設定されており、`librust_backend.a`が生成されることを確認済み。

## 3. 今後の開発計画

### 3.1. UI/UXの改善 (Qt/C++)
ユーザーからの要望に基づき、アプリケーションのUI/UXを魅力的なものに改善します。
-   **モダンなデザイン:** 全体的なテーマ、配色、レイアウトの検討。
-   **VMステータス表示:** VMの現在の状態（実行中、停止中、一時停止など）を視覚的に分かりやすく表示。
-   **VM設定の管理:** RAM、CPUコア数、ネットワーク設定、ストレージ設定など、QEMUの各種設定をUIから変更・保存できる機能。
-   **Windowsアプリケーションのリスト表示と起動:**
    -   VM内にインストールされているWindowsアプリケーションを検出し、リスト表示する機能。
    -   リストから選択したアプリケーションをRemoteApp経由で起動する機能。
    -   アプリケーションのアイコン表示。

### 3.2. シームレスなWindowsアプリケーション連携 (Rust/QEMU/RDP)
QEMU/KVMとRDP (RemoteApp) を利用して、WindowsアプリケーションをLinuxデスクトップにシームレスに表示する機能を実装します。
-   **RDP RemoteAppの有効化:** Windows VM内でRemoteApp機能を設定・有効化する自動化またはガイダンス。
-   **`freerdp`連携:** Rustバックエンドから`freerdp`コマンドラインツールを呼び出し、特定のWindowsアプリケーションのウィンドウをLinuxデスktopに表示。
-   **アプリケーション検出:** Windows VM内のアプリケーションリストを動的に取得する方法の検討（例: PowerShellスクリプトの実行、共有フォルダ経由での情報取得）。

### 3.3. 高度なVM管理機能 (Rust/QEMU)
-   **スナップショット管理:** VMのスナップショットの作成、復元、削除。
-   **ネットワーク設定:** ブリッジ接続、NATなど、より柔軟なネットワーク設定オプション。
-   **共有フォルダ:** LinuxホストとWindowsゲスト間でのファイル共有機能。

### 3.4. エラーハンドリングと堅牢性
-   QEMUプロセスの異常終了時のハンドリング。
-   設定ファイルの破損や不正な値に対する保護。
-   ユーザーへの分かりやすいエラーメッセージの表示。

## 4. 次のステップ

ユーザーからのUI/UXに関する具体的な要望をお待ちしております。それに基づいて、UIの改善から着手します。
